---
description: 数据整理概述
title: 数据定形概述 |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- data shaping [ADO], overview
ms.assetid: 4cb5fd29-4e56-46ac-ae48-a6771c321c0c
author: rothja
ms.author: jroth
ms.openlocfilehash: dbe025e38960b458c2ad5a224bad44c37868d51f
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/10/2021
ms.locfileid: "100037647"
---
# <a name="data-shaping-overview"></a>数据整理概述
*数据定形* 指的是在查询中的两个或多个逻辑实体之间建立层次关系。 可以在一个记录 [集](../../reference/ado-api/recordset-object-ado.md)的记录之间的父子关系中查看层次结构，也可以在一个或多个记录 (也称为另一个 **记录集** 的章节) 。 在父子关系中，父 **记录集** 包含子 **记录集**。 例如，客户和订单就是这种层次结构关系。 对于数据库中的每个客户，可以有零个或多个订单。 层次结构关系可以是递归的，也就是说，孙记录可以嵌套在子记录中。 原则上，分层记录可以嵌套到任何深度。 在实践中，ADO 将递归限制在最多512个 **记录集**。  
  
 通常，形状 **记录集** 的列可以包含来自数据提供程序的数据，例如 Microsoft® SQL Server、对另一 **记录集** 的引用、从 **记录集** 的单个行上的计算派生的值，或对整个 **记录集** 的列的操作派生的值。 列还可以是新的，也可以是空的。  
  
 检索包含对另一个 **记录集** 的引用的列的值时，ADO 自动返回由引用表示的实际 **记录集** 。 对 **记录集** 的引用实际上是对子元素子集的引用，称为 *章节*。 单个父项可以引用多个子 **记录集**。  
  
 ADO 对数据定形的支持使你可以查询数据源并返回一个 **记录集** ，其中 (父) 记录表示 (子) **记录集**。 在客户订单方案中，您可以使用数据定形来检索客户的信息，以及单个查询中每个客户的订单。 生成的 **记录集** 也称为整形 **记录集**。  
  
 此外，使用 ADO 中的数据定形，还可以通过使用 **new** 关键字说明父 **记录集和子记录集** 的字段，来创建新的 **记录集** 对象，而不使用基础数据源。 然后，可以用数据填充新的 **Recordset** 对象并持久存储。 开发人员还可以执行各种计算或聚合 (例如，在子字段上执行 **SUM**、 **AVG** 和 **MAX**) 。 数据定形还 **可以通过对** 子记录集中的记录进行分组来 **创建父记录集，** 并为子级中的每个组在父级中放置一行。  
  
 通过使用 **联接** 语法，可以使用常规 SQL 来检索数据，但这可能会导致效率低下且难以使用，因为冗余的父数据会在为给定的父子关系返回的每个记录中重复。 数据定形可以将父记录 **集中** 的单个父记录与子 **记录集中** 的多个子记录相关联，从而避免 **联接** 的冗余。 大多数人发现父子多 **记录集** 编程模型比单 **记录集联接** 模型更自然且更容易使用。