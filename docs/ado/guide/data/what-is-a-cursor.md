---
description: 什么是游标？
title: 什么是游标？ | Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- cursors [ADO], about cursors
ms.assetid: 596eb4b6-c22f-4cde-b23f-172dd66c3161
author: rothja
ms.author: jroth
ms.openlocfilehash: 915d41f78de6c789c82bca3d729aa2c28ff26f27
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/10/2021
ms.locfileid: "100032259"
---
# <a name="what-is-a-cursor"></a>什么是游标？
关系数据库中的操作会对整个行集起作用。 由 SELECT 语句返回的行集包括满足该语句的 WHERE 子句中条件的所有行。 这种由语句返回的完整行集称为结果集。 应用程序（尤其是交互和联机的应用程序）无法始终有效地将整个结果集作为一个单元来处理。 这些应用程序需要一种机制以便每次处理一行或一部分行。 游标就是提供这种机制的对结果集的一种扩展。  
  
 游标是通过游标库实现的。 游标库是软件，通常作为数据库系统或数据访问 API 的一部分来实现，用于管理从数据源返回的数据的属性 () 的结果集。 这些属性包括并发管理、结果集中的位置、返回的行数，以及是否可以向前或向后移动 (或) 通过结果集 (可滚动性) 。  
  
 游标将跟踪结果集中的位置，并允许您对结果集逐行执行多个操作，而无需返回到原始表。 换言之，游标在概念上返回基于数据库中的表的结果集。 游标是如此，因为它指示结果集中的当前位置，正如计算机屏幕上的光标指示当前位置。  
  
 在继续之前，请务必熟悉游标概念，以了解 ADO 中的用法细节。  
  
 使用游标，可以：  
  
-   指定结果集中特定行的位置。  
  
-   基于当前结果集位置检索一行或行块。  
  
-   修改结果集中当前位置的行中的数据。  
  
-   定义其他用户所做的数据更改的不同敏感度级别。  
  
 例如，假设有一个应用程序，该应用程序向潜在买家显示可用产品的列表。 买方滚动列表，查看产品详细信息和成本，最后选择购买产品。 还会为列表的其余部分进行其他滚动和选择。 就买家而言，产品一次显示一个，但应用程序使用可滚动的游标在结果集上上下浏览。  
  
 可以通过多种方式使用游标：  
  
-   不包含任何行。  
  
-   在单个表中包含部分或全部行。  
  
-   用于逻辑联接表中的部分或全部行。  
  
-   在游标或字段级别上为只读或可更新。  
  
-   作为只进或完全可滚动。  
  
-   将游标键集放在服务器上。  
  
-   对基础表的更改是由其他应用程序引起的， (例如成员身份、排序、插入、更新和删除) 。  
  
-   服务器或客户端上的现有。  
  
 只读游标有助于用户浏览结果集，读取/写入游标可以实现各个行更新。 可以通过键集来定义复杂游标，以指向基表行。 尽管某些游标是向前方向的，但其他游标可以来回移动，并基于其他应用程序对数据库的更改提供结果集的动态刷新。  
  
 并非所有应用程序都需要使用游标来访问或更新数据。 某些查询只需使用游标即可进行直接行更新。 游标应为你选择检索数据的最后一种方法之一，然后你应该选择可能的影响最小的游标。 使用存储过程创建结果集时，不能使用游标 edit 或 update 方法更新结果集。  
  
## <a name="concurrency"></a>并发  
 在某些多用户应用程序中，向最终用户呈现的数据非常重要，这一点非常重要。 此类系统的典型示例是一个航空公司预订系统，其中许多用户可能会在给定航班上争用同一座位 (因此) 一条记录。 在这种情况下，应用程序设计必须处理单个记录的并发操作。  
  
 在其他应用程序中，并发性并不重要。 在这种情况下，使数据始终保持最新状态所涉及的费用不会进行调整。  
  
## <a name="position"></a>位置  
 游标还会跟踪结果集中的当前位置。 将光标位置视为指向当前记录的指针，类似于数组索引指向数组中特定位置处的值的方式。  
  
## <a name="scrollability"></a>可滚动性  
 您的应用程序所使用的游标类型还会影响在结果集中的行的向前和向后移动的能力;这有时称为可滚动性。 通过结果集向前 *和* 向后移动的能力增加了游标的复杂性，因此实现起来更昂贵。 出于此原因，应仅在必要时才使用此功能的游标。
